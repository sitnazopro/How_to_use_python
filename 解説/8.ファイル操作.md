# Pythonの応用：ファイル操作 (ファイルの読み書き)

プログラムのデータを永続的に保存したり、外部のデータファイルを読み込んだりするために、ファイル操作は欠かせないスキルです。Pythonでは、テキストファイルやCSVファイルなどを簡単に扱うことができます。

---

## 1. ファイルを開く (`open` と `with`)

ファイルを操作するには、まず `open()` 関数でファイルを開きます。その際、後片付け（ファイルを閉じる処理）を忘れると問題が発生することがあるため、`with` 文と一緒に使うのが一般的です。

`with` 文を使うと、ブロック内の処理が終わった後、ファイルが自動的に閉じられるため安全です。

**構文:**
```python
with open("ファイル名", "モード", encoding="utf-8") as f:
    # ファイルに対する処理
```
-   **ファイル名:** 操作したいファイルへのパスです。
-   **モード:** ファイルをどのように開くかを指定します（読み込み、書き込みなど）。
-   **`encoding="utf-8"`:** 文字化けを防ぐためのおまじないです。日本語を含むテキストファイルを扱う際は、基本的に指定します。
-   **`f`:** 開いたファイルを表すオブジェクトです。この変数を使って操作します。

---

## 2. ファイルの読み込み (Read)

ファイルの内容を読み込むには、モードを `'r'` にします。

**例: `hello.txt` を読み込む**
```python
# hello.txt というファイルに "こんにちは、世界！" と書かれているとします。

try:
    with open("hello.txt", "r", encoding="utf-8") as f:
        content = f.read()  # ファイル全体を一つの文字列として読み込む
        print(content)
except FileNotFoundError:
    print("エラー: hello.txt が見つかりません。")
```

### 主な読み込みメソッド
-   `f.read()`: ファイルの全内容を1つの文字列として読み込みます。
-   `f.readline()`: ファイルから1行だけを読み込みます。呼び出すたびに次の行に進みます。
-   `f.readlines()`: ファイルの全内容を1行ずつのリストとして読み込みます。

---

## 3. ファイルへの書き込み (Write)

ファイルに新しい内容を書き込むには、モードを `'w'` にします。

**注意:** モード `'w'` は、**ファイルが既に存在する場合、その内容をすべて上書きします**。ファイルが存在しない場合は、新しく作成されます。

**例: `output.txt` に書き込む**
```python
with open("output.txt", "w", encoding="utf-8") as f:
    f.write("これは新しいファイルです。\n") # \n は改行コード
    f.write("Pythonからの書き込みテスト。\n")

# このコードを実行すると、output.txtが作成され、2行のテキストが書き込まれる
```

---

## 4. ファイルへの追記 (Append)

既存のファイルの内容を消さずに、末尾に新しい内容を追加したい場合は、モードを `'a'` にします。

**例: `log.txt` に追記する**
```python
with open("log.txt", "a", encoding="utf-8") as f:
    # 現在の日時などを追記するイメージ
    f.write("プログラムが実行されました。\n")
```
このコードを複数回実行すると、`log.txt` に「プログラムが実行されました。」という行がどんどん追加されていきます。

ファイル操作は、エラーハンドリング（特に `FileNotFoundError`）と組み合わせて使うことで、より堅牢なプログラムになります。
